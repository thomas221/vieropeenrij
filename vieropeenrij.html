<html>

<head>
<style>
.insert {
  width: 60px;
  height: 30px;
  display: block;
  margin-left: auto;
  margin-right: auto;
}
.cell {
  width: 60px;
  height: 60px;
  border: 2px solid black;
}
</style>
</head>

<body>
  <table>
    <tr>
      <td><button class="insert" onclick="insert(0)">A</button></td>
      <td><button class="insert" onclick="insert(1)">B</button></td>
      <td><button class="insert" onclick="insert(2)">C</button></td>
      <td><button class="insert" onclick="insert(3)">D</button></td>
      <td><button class="insert" onclick="insert(4)">E</button></td>
      <td><button class="insert" onclick="insert(5)">F</button></td>
      <td><button class="insert" onclick="insert(6)">G</button></td>
    </tr>
    <tr>
      <td><div class="cell cell00"/></td>
      <td><div class="cell cell01"/></td>
      <td><div class="cell cell02"/></td>
      <td><div class="cell cell03"/></td>
      <td><div class="cell cell04"/></td>
      <td><div class="cell cell05"/></td>
      <td><div class="cell cell06"/></td>
    </tr>
    <tr>
      <td><div class="cell cell10"/></td>
      <td><div class="cell cell11"/></td>
      <td><div class="cell cell12"/></td>
      <td><div class="cell cell13"/></td>
      <td><div class="cell cell14"/></td>
      <td><div class="cell cell15"/></td>
      <td><div class="cell cell16"/></td>
    </tr>
    <tr>
      <td><div class="cell cell20"/></td>
      <td><div class="cell cell21"/></td>
      <td><div class="cell cell22"/></td>
      <td><div class="cell cell23"/></td>
      <td><div class="cell cell24"/></td>
      <td><div class="cell cell25"/></td>
      <td><div class="cell cell26"/></td>
    </tr>
    <tr>
      <td><div class="cell cell30"/></td>
      <td><div class="cell cell31"/></td>
      <td><div class="cell cell32"/></td>
      <td><div class="cell cell33"/></td>
      <td><div class="cell cell34"/></td>
      <td><div class="cell cell35"/></td>
      <td><div class="cell cell36"/></td>
    </tr>
    <tr>
      <td><div class="cell cell40"/></td>
      <td><div class="cell cell41"/></td>
      <td><div class="cell cell42"/></td>
      <td><div class="cell cell43"/></td>
      <td><div class="cell cell44"/></td>
      <td><div class="cell cell45"/></td>
      <td><div class="cell cell46"/></td>
    </tr>
    
  </table>
  
  <script>
  let filled=[0,0,0,0,0,0,0];
  let playerIsRed=true;

function insert(column){
  let cellToChange =document.getElementsByClassName("cell"+(4-filled[column])+column);
  filled[column]++;
  if(playerIsRed){
	cellToChange[0].style.backgroundColor = "red";
  }else{
	cellToChange[0].style.backgroundColor = "yellow";
  }
  checkIfVertical4OpEenRij(column);
  checkIfHorizontal4OpEenRij(column);
  checkIfAscendingDiagonal4OpEenRij(column);
  checkIfDescendingDiagonal4OpEenRij(column);
  playerIsRed=!playerIsRed;
}

function checkIfVertical4OpEenRij(column){
	let countRed=0;
	let countYellow=0;
	var i;
	for(i=0;i<5;i++){
		if(isRed(i,column)){
			countRed++;
			countYellow=0;
			if(countRed>=4){
				alert("Red won!");
			}
		}else if(isYellow(i,column)){
			countYellow++;
			countRed=0;
			if(countYellow>=4){
				alert("Yellow won!");
			}
		}else{
			countRed=0;
			countYellow=0;
		}
	}


}

function checkIfHorizontal4OpEenRij(column){
	let row=filled[column]-1;
	let countRed=0;
	let countYellow=0;
	var i;
	for(i=0;i<7;i++){
		if(isRed(row,i)){
			countRed++;
			countYellow=0;
			if(countRed>=4){
				alert("Red won!");
			}	
		}else if(isYellow(row,i)){
			countYellow++;
			countRed=0;
			if(countYellow>=4){
				alert("Yellow won!");
			}	
		}else{
			countRed=0;
			countYellow=0;
		}
	}


}

function checkIfAscendingDiagonal4OpEenRij(column){
	let row=filled[column]-1;
	let countRed=0;
	let countYellow=0;
	var i;
	for(i=-3;i<4;i++){
		if(row+i>=0 && column+i>=0 && row+i<5 && column+i<7 && isRed(row+i,column+i)){
			countRed++;
			countYellow=0;
			if(countRed>=4){
				alert("Red won!");
			}
		}else if(row+i>=0 && column+i>=0 && row+i<5 && column+i<7 && isYellow(row+i,column+i)){
			countYellow++;
			countRed=0;
			if(countYellow>=4){
				alert("Yellow won!");
			}
		}else{
			countRed=0;
			countYellow=0;
		}
		
	}


}

function checkIfDescendingDiagonal4OpEenRij(column){
	let row=filled[column]-1;
	let countRed=0;
	let countYellow=0;
	var i;
	for(i=-3;i<4;i++){
		if(row-i>=0 && column+i>=0 && row-i<5 && column+i<7 && isRed(row-i,column+i)){
			countRed++;
			countYellow=0;
			if(countRed>=4){
				alert("Red won!");
			}
		}else if(row-i>=0 && column+i>=0 && row-i<5 && column+i<7 && isYellow(row-i,column+i)){
			countYellow++;
			countRed=0;
			if(countYellow>=4){
				alert("Yellow won!");
			}
		}else{
			countRed=0;
			countYellow=0;
		}
	}
}

function isRed(row,column){
	let cell = document.getElementsByClassName("cell"+(4-row)+column);
	return cell[0].style.backgroundColor=="red";
}

function isYellow(row,column){
	let cell = document.getElementsByClassName("cell"+(4-row)+column);
	return cell[0].style.backgroundColor=="yellow";
}

  </script>

</body>
</html>